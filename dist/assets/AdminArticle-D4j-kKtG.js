import { m as M } from './modalMixins-gb6TmebJ.js'; import { _ as $, o as d, c as r, b as t, y as h, z as p, F as A, v as w, g as b, t as _, I as y, d as v, w as k, r as g, e as P } from './index-DrL7xUhK.js'; const V = { props: { article: Object }, data () { return { modal: null, tempArticle: { isPublic: !0 }, tags: ['漢堡', '披薩', '飲料', '牛排', '沙拉'] } }, methods: { updateArticle () { const i = Math.floor(Date.now() / 1e3); this.tempArticle.create_at = i, this.$emit('update-article', this.tempArticle) }, addTag (i) { this.tempArticle.tag = [i] }, showModal () { this.modal.show() }, hideModal () { this.modal.hide() } }, watch: { article () { this.tempArticle = { ...this.article, isPublic: this.article.isPublic || !1 } } }, mixins: [M] }; const T = { class: 'modal fade', tabindex: '-1', ref: 'myModal' }; const C = { class: 'modal-dialog modal-xl' }; const U = { class: 'modal-content' }; const E = t('div', { class: 'modal-header bg-primary' }, [t('h5', { class: 'modal-title text-light' }, '新增文章'), t('button', { type: 'button', class: 'btn-close', 'data-bs-dismiss': 'modal', 'aria-label': 'Close' })], -1); const L = { class: 'modal-body' }; const I = { class: 'row' }; const N = { class: 'col-12' }; const R = { class: 'row' }; const D = { class: 'col-6 mb-3' }; const B = t('label', { for: 'title', class: 'form-label' }, '文章名稱', -1); const S = { class: 'col-6' }; const q = t('label', { for: 'author', class: 'form-label' }, '作者名稱', -1); const H = { class: 'col-6 mb-3' }; const O = t('label', { for: 'img', class: 'form-label' }, '請輸入圖片網址', -1); const j = ['src']; const F = { class: 'col-6 mb-3' }; const z = t('label', { for: 'tag', class: 'form-label' }, '標籤', -1); const G = { class: 'd-flex p-0' }; const J = ['onClick']; const K = { class: 'col-12 mb-3' }; const Q = t('label', { for: 'description', class: 'form-label' }, '文章描述', -1); const W = { class: 'col-12' }; const X = t('label', { for: 'content', class: 'form-label' }, '文章內容', -1); const Y = { class: 'mt-2' }; const Z = t('label', { class: 'form-check-label ms-1', for: 'isPublic' }, '是否公開', -1); const tt = { class: 'modal-footer' }; const et = t('button', { type: 'button', class: 'btn btn-dark', 'data-bs-dismiss': 'modal' }, '取消', -1); function st (i, e, c, a, l, n) { return d(), r('div', T, [t('div', C, [t('div', U, [E, t('div', L, [t('div', I, [t('div', N, [t('div', R, [t('div', D, [B, h(t('input', { type: 'text', class: 'form-control', 'onUpdate:modelValue': e[0] || (e[0] = s => l.tempArticle.title = s), placeholder: '請輸入文章名稱', id: 'title' }, null, 512), [[p, l.tempArticle.title]])]), t('div', S, [q, h(t('input', { type: 'text', class: 'form-control', placeholder: '請輸入作者名稱', id: 'author', 'onUpdate:modelValue': e[1] || (e[1] = s => l.tempArticle.author = s) }, null, 512), [[p, l.tempArticle.author]])]), t('div', H, [O, h(t('input', { type: 'text', class: 'form-control mb-3', placeholder: '請輸入圖片網址', id: 'img', 'onUpdate:modelValue': e[2] || (e[2] = s => l.tempArticle.image = s) }, null, 512), [[p, l.tempArticle.image]]), t('img', { src: l.tempArticle.image, class: 'w-25 h-50', alt: 'article-modal-img' }, null, 8, j)]), t('div', F, [z, t('ul', G, [(d(!0), r(A, null, w(l.tags, s => (d(), r('li', { key: s }, [t('button', { class: 'btn btn-primary me-2', type: 'button', onClick: b(f => n.addTag(s), ['prevent']) }, _(s), 9, J)]))), 128))])]), t('div', K, [Q, h(t('input', { type: 'text', class: 'form-control', placeholder: '請輸入文章描述', id: 'description', 'onUpdate:modelValue': e[3] || (e[3] = s => l.tempArticle.description = s) }, null, 512), [[p, l.tempArticle.description]])]), t('div', W, [X, h(t('textarea', { name: '', id: '', cols: '30', rows: '10', 'onUpdate:modelValue': e[4] || (e[4] = s => l.tempArticle.content = s), class: 'form-control' }, null, 512), [[p, l.tempArticle.content]])]), t('div', Y, [h(t('input', { id: 'isPublic', class: 'form-check-input', type: 'checkbox', 'onUpdate:modelValue': e[5] || (e[5] = s => l.tempArticle.isPublic = s) }, null, 512), [[y, l.tempArticle.isPublic]]), Z])])])])]), t('div', tt, [et, t('button', { type: 'button', class: 'btn btn-primary', onClick: e[6] || (e[6] = b((...s) => n.updateArticle && n.updateArticle(...s), ['prevent'])) }, '確認')])])])], 512) } const lt = $(V, [['render', st]]); const it = { VITE_APP_URL: 'https://vue3-course-api.hexschool.io/v2', VITE_APP_PATH: 'david555', BASE_URL: './', MODE: 'production', DEV: !1, PROD: !0, SSR: !1 }; const { VITE_APP_URL: u, VITE_APP_PATH: m } = it; const ot = { data () { return { tempArticle: {}, articles: [], isNewArticle: !1, isLoading: !1 } }, components: { ArticleModal: lt }, methods: { openArticleEditModal (i) { const e = `${u}/api/${m}/admin/article/${i.id}`; this.$http.get(e).then(a => { this.tempArticle = a.data.article, this.isNewArticle = !1 }).catch(a => { a.response.data.message && this.$swal('錯誤', '你所查看的API不存在', 'error') }), this.$refs.articleModal.showModal() }, openArticleModal () { this.tempArticle = {}; const i = this.$refs.articleModal; this.isNewArticle = !0, i.showModal() }, updateArticle (i) { this.tempArticle = i, console.log(this.tempArticle); let e = `${u}/api/${m}/admin/article`; let c = 'post'; this.isNewArticle || (e = `${u}/api/${m}/admin/article/${this.tempArticle.id}`, c = 'put'), this.$http[c](e, { data: this.tempArticle }).then(a => { a.data.success && (console.log(this.tempArticle), this.$refs.articleModal.hideModal(), this.getArticles()) }).catch(a => { a.response.data.message && this.$swal('錯誤', '無法新增或修改產品', 'error') }) }, getArticles () { this.isLoading = !0; const i = `${u}/api/${m}/admin/articles`; this.$http.get(i).then(e => { e.data.success && (this.articles = e.data.articles, console.log(this.articles), setTimeout(() => { this.isLoading = !1 }, 800)) }).catch(e => { e.response.data.message && this.$swal('錯誤', '你所查看的API不存在', 'error') }) }, delArticle (i) { const e = `${u}/api/${m}/admin/article/${i.id}`; this.$http.delete(e).then(c => { c.data.success && this.getArticles() }).catch(c => { c.response.data.message && this.$swal('錯誤', '刪除文章失敗', 'error') }) } }, mounted () { this.getArticles() } }; const ct = t('div', { class: 'loadingio-spinner-spin-nq4q5u6dq7r' }, [t('div', { class: 'ldio-x2uulkbinbj' }, [t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')])])], -1); const at = { class: 'container' }; const nt = { class: 'text-end my-4' }; const dt = { class: 'table table-striped productTable' }; const rt = t('thead', null, [t('tr', null, [t('th', { width: '10' }), t('th', { width: '10' }), t('th', null, '標題'), t('th', null, '描述'), t('th', { width: '100' }, '作者'), t('th', { width: '100' }, '發布日期'), t('th', { width: '150', class: 'text-center' }, '狀態'), t('th', { width: '100' }, '編輯')])], -1); const ht = { class: 'pt-3' }; const pt = ['onClick']; const ut = t('i', { class: 'bi bi-x h3 text-danger' }, null, -1); const mt = [ut]; const _t = t('td', null, null, -1); const bt = ['src']; const At = { class: 'text-truncate d-block', style: { width: '300px' } }; const ft = { key: 0, class: 'bg-success text-center activeRounded' }; const vt = t('span', null, '公開', -1); const gt = [vt]; const $t = { key: 1, class: 'bg-warning text-center activeRounded' }; const wt = t('span', null, '不公開', -1); const xt = [wt]; const Mt = ['onClick']; function yt (i, e, c, a, l, n) { const s = g('VueLoading'); const f = g('ArticleModal'); return d(), r(A, null, [v(s, { active: l.isLoading }, { default: k(() => [ct]), _: 1 }, 8, ['active']), t('div', at, [t('div', nt, [t('button', { class: 'btn btn-lg btn-primary', onClick: e[0] || (e[0] = b((...o) => n.openArticleModal && n.openArticleModal(...o), ['prevent'])) }, '新增文章')]), t('table', dt, [rt, t('tbody', null, [(d(!0), r(A, null, w(l.articles, o => (d(), r('tr', { key: o.id }, [t('td', ht, [t('a', { href: '#', onClick: b(x => n.delArticle(o), ['prevent']) }, mt, 8, pt)]), _t, t('td', null, [t('img', { class: '', width: '80', height: '50', src: o.image }, null, 8, bt), P(' ' + _(o.title), 1)]), t('td', null, [t('p', At, _(o.description), 1)]), t('td', null, _(o.author), 1), t('td', null, _(i.$filters.date(o.create_at)), 1), t('td', null, [o.isPublic ? (d(), r('div', ft, gt)) : (d(), r('div', $t, xt))]), t('td', null, [t('button', { type: 'button', class: 'btn btn-outline-dark', onClick: b(x => n.openArticleEditModal(o), ['prevent']) }, ' 編輯 ', 8, Mt)])]))), 128))])])]), v(f, { ref: 'articleModal', article: l.tempArticle, onUpdateArticle: n.updateArticle }, null, 8, ['article', 'onUpdateArticle'])], 64) } const Vt = $(ot, [['render', yt]]); export { Vt as default }
