import{m as k}from"./modalMixins-gb6TmebJ.js";import{_ as O,o as l,c as d,b as t,t as s,F as _,v as h,f as y,g as p,d as m,w,r as b}from"./index-DrL7xUhK.js";const M={props:["order"],data(){return{modal:null,tempOrder:{}}},watch:{order(){this.tempOrder=this.order}},mixins:[k]},x={class:"modal fade",id:"orderModal",tabindex:"-1",role:"dialog","aria-hidden":"true",ref:"myModal"},P={class:"modal-dialog modal-lg",role:"document"},E={class:"modal-content border-0"},L=t("div",{class:"modal-header bg-primary text-white"},[t("h5",{class:"modal-title"},[t("span",{class:"fw-bold"},"訂單細節")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},C={class:"row"},A={class:"col-md-6"},R=t("h3",{class:"fw-bold"},"訂單細節",-1),T={class:"table"},q=t("th",{width:"150"},"訂單編號",-1),B=t("th",null,"下單時間",-1),D=t("th",null,"付款時間",-1),I={key:0},S={key:1},N=t("th",null,"付款狀態",-1),U={key:0,class:"text-primary"},F={key:1,class:"text-muted"},H=t("th",null,"總金額",-1),j=t("h3",{class:"fw-bold"},"選購商品",-1),z={class:"table"},G=t("thead",null,[t("tr")],-1),J={class:"text-end"},K={class:"col-md-6"},Q=t("h3",{class:"fw-bold"},"用戶資料",-1),W={class:"table"},X={key:0},Y=t("th",{width:"100"},"姓名",-1),Z=t("th",null,"Email",-1),tt=t("th",null,"電話",-1),et=t("th",null,"地址",-1),st={class:"modal-footer"},lt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function dt(o,n,c,g,e,u){return l(),d("div",x,[t("div",P,[t("div",E,[L,t("div",V,[t("div",C,[t("div",A,[R,t("table",T,[t("tbody",null,[t("tr",null,[q,t("td",null,s(e.tempOrder.id),1)]),t("tr",null,[B,t("td",null,s(o.$filters.date(e.tempOrder.create_at)),1)]),t("tr",null,[D,t("td",null,[e.tempOrder.paid_date?(l(),d("span",I,s(o.$filters.date(e.tempOrder.paid_date)),1)):(l(),d("span",S,"時間不正確"))])]),t("tr",null,[N,t("td",null,[e.tempOrder.is_paid?(l(),d("strong",U,"已付款")):(l(),d("span",F,"尚未付款"))])]),t("tr",null,[H,t("td",null,s(e.tempOrder.total),1)])])]),j,t("table",z,[G,t("tbody",null,[(l(!0),d(_,null,h(e.tempOrder.products,i=>(l(),d("tr",{key:i.id},[t("th",null,s(i.product.title),1),t("td",J,s(i.qty),1),t("td",null,s(i.product.unit),1)]))),128))])])]),t("div",K,[Q,t("table",W,[e.tempOrder.user?(l(),d("tbody",X,[t("tr",null,[Y,t("td",null,s(e.tempOrder.user.name),1)]),t("tr",null,[Z,t("td",null,s(e.tempOrder.user.email),1)]),t("tr",null,[tt,t("td",null,s(e.tempOrder.user.tel),1)]),t("tr",null,[et,t("td",null,s(e.tempOrder.user.address),1)])])):y("",!0)])])])]),t("div",st,[lt,t("button",{type:"button",class:"btn btn-primary",onClick:n[0]||(n[0]=p((...i)=>o.hideModal&&o.hideModal(...i),["prevent"]))},"確認")])])])],512)}const ot=O(M,[["render",dt]]);var nt={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"david555",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:v,VITE_APP_PATH:f}=nt,it={components:{OrderModal:ot},data(){return{orders:[],tempOrder:{},isLoading:""}},methods:{getOrders(){this.isLoading=!0;const o=`${v}/api/${f}/admin/orders`;this.$http.get(o).then(n=>{n.data.success&&(setTimeout(()=>{this.isLoading=!1},800),this.orders=n.data.orders)}).catch(n=>{n.response.data.message&&this.$swal("錯誤","無法取得資料","error")})},openModal(o){this.tempOrder={...o},this.$refs.modal.showModal()},delOrder(o){const n=`${v}/api/${f}/admin/order/${o.id}`;this.$http.delete(n).then(c=>{c.data.success&&this.getOrders()}).catch(c=>{c.response.data.message&&this.$swal("錯誤","訂單刪除失敗","error")})}},mounted(){this.getOrders()}},rt=t("div",{class:"loadingio-spinner-spin-nq4q5u6dq7r"},[t("div",{class:"ldio-x2uulkbinbj"},[t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")]),t("div",null,[t("div")])])],-1),at={class:"table table-striped mt-4"},ct=t("thead",null,[t("tr",null,[t("th"),t("th",null,"購買時間"),t("th",null,"Email"),t("th",null,"購買款項"),t("th",{width:"150"},"應付金額"),t("th",{width:""},"是否付款"),t("th",null,"編輯")])],-1),_t={href:"#"},ut=["onClick"],ht={class:"text-right"},pt={key:0,class:"bg-success text-center activeRounded"},mt=t("span",null,"已付款",-1),bt=[mt],vt={key:1,class:"bg-warning text-center activeRounded"},ft=t("span",null,"未付款",-1),Ot=[ft],yt={class:"btn-group"},gt=["onClick"];function $t(o,n,c,g,e,u){const i=b("VueLoading"),$=b("OrderModal");return l(),d(_,null,[m(i,{active:e.isLoading},{default:w(()=>[rt]),_:1},8,["active"]),t("table",at,[ct,t("tbody",null,[e.orders?(l(!0),d(_,{key:0},h(e.orders,r=>(l(),d("tr",{key:r.id},[t("td",null,[t("a",_t,[t("i",{class:"bi bi-x h3 text-danger",onClick:p(a=>u.delOrder(r),["prevent"])},null,8,ut)])]),t("td",null,s(o.$filters.date(r.create_at)),1),t("td",null,[t("span",null,s(r.user.email),1)]),t("td",null,[(l(!0),d(_,null,h(r.products,a=>(l(),d("ul",{class:"list-unstyled",key:a.id},[t("li",null,s(a.product.title)+" /"+s(a.qty)+" "+s(a.product.unit),1)]))),128))]),t("td",ht,s(r.total),1),t("td",null,[r.is_paid?(l(),d("div",pt,bt)):(l(),d("div",vt,Ot))]),t("td",null,[t("div",yt,[t("button",{class:"btn btn-dark btn-sm",onClick:p(a=>u.openModal(r),["prevent"])},"檢視",8,gt)])])]))),128)):y("",!0)])]),m($,{ref:"modal",order:e.tempOrder},null,8,["order"])],64)}const Mt=O(it,[["render",$t]]);export{Mt as default};
