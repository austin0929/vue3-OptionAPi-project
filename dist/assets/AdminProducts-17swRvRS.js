import{P as A}from"./PaginationComponent-MN3riGI7.js";import{m as T}from"./modalMixins-DdrMPlSF.js";import{_ as x,o as d,c as r,b as t,y as c,z as p,I as w,F as v,v as V,g as M,d as f,r as g,e as y,f as C,t as b}from"./index-CoW_epj6.js";import{i as U}from"./index-Bzn_gtXS.js";import{V as $}from"./VueLoading-61m2rGh4.js";var E={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"david555",BASE_URL:"/vue3-OptionAPi-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:L,VITE_APP_PATH:I}=E,R={props:["product"],data(){return{modal:null,tempProduct:{}}},methods:{addProduct(){this.$emit("update-product",this.tempProduct)},uploadFile(){const i=this.$refs.fileInput.files[0],e=new FormData;e.append("up-load-file",i);const l=`${L}/api/${I}/admin/upload`;this.$http.post(l,e,{headers:{"Content-Type":"multipart/form-data"}}).then(n=>{n.data.success&&(this.tempProduct.imageUrl=n.data.imageUrl,this.tempProduct.imagesUrl.push(n.data.imageUrl),this.$refs.fileInput.value="")}).catch(n=>{n.response.data.message&&this.$swal("錯誤","無法上傳圖片","error")})}},watch:{product(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])}},mixins:[T]},D={class:"modal fade",tabindex:"-1",ref:"myModal"},F={class:"modal-dialog modal-lg"},S={class:"modal-content"},B=t("div",{class:"modal-header bg-primary"},[t("h5",{class:"modal-title text-light"},"新增產品"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},N={class:"row"},O={class:"col-8"},j={class:"row"},z={class:"col-4"},q=t("label",{for:"title",class:"form-label"},"產品名稱",-1),G={class:"col-4"},J=t("label",{for:"category",class:"form-label"},"分類",-1),K={class:"col-4"},Q=t("label",{for:"unit",class:"form-label"},"單位",-1),W={class:"col-6"},X=t("label",{for:"origin_price",class:"form-label mt-3"},"原價",-1),Y={class:"col-6"},Z=t("label",{for:"price",class:"form-label mt-3"},"特價",-1),tt=t("label",{for:"description",class:"form-label mt-3"},"產品描述",-1),et=t("label",{for:"content",class:"form-label mt-3"},"產品說明",-1),ot={class:"mt-2"},st=t("label",{class:"form-check-label ms-1",for:"is_enabled"},"是否啟用",-1),lt={class:"col-4"},it=t("label",{for:"imgUrl",class:"form-label"},"輸入圖片網址",-1),nt=t("label",{for:"customFile",class:"form-label"},"上傳圖片",-1),dt=["src"],rt={key:0,class:"mt-3"},at=["src"],ct=["onUpdate:modelValue"],ut={class:"modal-footer"},pt=t("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal"}," 取消 ",-1);function mt(i,e,l,n,o,a){return d(),r("div",D,[t("div",F,[t("div",S,[B,t("div",H,[t("div",N,[t("div",O,[t("div",j,[t("div",z,[q,c(t("input",{type:"text",class:"form-control",placeholder:"請輸入產品名稱",id:"title","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.title=s)},null,512),[[p,o.tempProduct.title]])]),t("div",G,[J,c(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入產品分類","onUpdate:modelValue":e[1]||(e[1]=s=>o.tempProduct.category=s)},null,512),[[p,o.tempProduct.category]])]),t("div",K,[Q,c(t("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入產品單位","onUpdate:modelValue":e[2]||(e[2]=s=>o.tempProduct.unit=s)},null,512),[[p,o.tempProduct.unit]])]),t("div",W,[X,c(t("input",{type:"text",class:"form-control",id:"origin_price",placeholder:"請輸入產品原價","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.origin_price=s)},null,512),[[p,o.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",Y,[Z,c(t("input",{type:"text",class:"form-control",id:"price",placeholder:"請輸入產品價格","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.price=s)},null,512),[[p,o.tempProduct.price,void 0,{number:!0}]])]),t("div",null,[tt,c(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.description=s)},`\r
                  `,512),[[p,o.tempProduct.description]])]),t("div",null,[et,c(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入產品說明","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.content=s)},`\r
                  `,512),[[p,o.tempProduct.content]])]),t("div",ot,[c(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.is_enabled=s)},null,512),[[w,o.tempProduct.is_enabled]]),st])])]),t("div",lt,[t("div",null,[it,c(t("input",{type:"text",class:"form-control mb-3",id:"imgUrl",placeholder:"請輸入圖片網址","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.imageUrl=s)},null,512),[[p,o.tempProduct.imageUrl]]),nt,t("input",{type:"file",name:"file-to-upload",id:"customFile",onChange:e[9]||(e[9]=(...s)=>a.uploadFile&&a.uploadFile(...s)),ref:"fileInput",class:"form-control"},null,544),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl},null,8,dt)]),Array.isArray(o.tempProduct.imagesUrl)?(d(),r("div",rt,[(d(!0),r(v,null,V(o.tempProduct.imagesUrl,(s,m)=>(d(),r("div",{key:s},[t("img",{src:s,class:"img-fluid object-fit-cover",style:{height:"150px",width:"100%"}},null,8,at),c(t("input",{type:"text","onUpdate:modelValue":P=>o.tempProduct.imagesUrl[m]=P,class:"form-control"},null,8,ct),[[p,o.tempProduct.imagesUrl[m]]])]))),128)),o.tempProduct.imagesUrl.length===0||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(d(),r("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[10]||(e[10]=s=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(d(),r("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[11]||(e[11]=s=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 "))])):M("",!0)])])]),t("div",ut,[pt,t("button",{type:"button",class:"btn btn-primary",onClick:e[12]||(e[12]=(...s)=>a.addProduct&&a.addProduct(...s))}," 確認 ")])])])],512)}const _t=x(R,[["render",mt]]);var ht={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"david555",BASE_URL:"/vue3-OptionAPi-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:_,VITE_APP_PATH:h}=ht,Pt={components:{Pagination:A,ProductModal:_t,VueLoading:$},data(){return{products:[],pagination:{},tempProduct:{},isNewProduct:!1,isLoading:!1}},methods:{getProducts(i=1){this.isLoading=!0;const e=`${_}/api/${h}/admin/products?page=${i}`;this.$http.get(e).then(l=>{l.data.success&&(this.products=l.data.products,this.pagination=l.data.pagination,setTimeout(()=>{this.isLoading=!1},800))}).catch(l=>{l.response.data.message&&this.$swal("錯誤","你所查看的API不存在","error")})},openModal(i,e){i?this.tempProduct={}:this.tempProduct={...e},this.isNewProduct=i,this.$refs.modalComponent.showModal()},updateProduct(i){this.tempProduct=i;let e=`${_}/api/${h}/admin/product`,l="post";this.isNewProduct||(e=`${_}/api/${h}/admin/product/${i.id}`,l="put"),this.$http[l](e,{data:this.tempProduct}).then(n=>{n.data.success&&(U("更新產品狀態",{theme:"auto",type:"success",autoClose:1e3,hideProgressBar:!0,dangerouslyHTMLString:!0}),this.$refs.modalComponent.hideModal(),this.getProducts())}).catch(n=>{n.response.data.message&&U("新增產品失敗",{theme:"auto",type:"error",autoClose:1e3,hideProgressBar:!0,dangerouslyHTMLString:!0})})},delProduct(i){const e=`${_}/api/${h}/admin/product/${i.id}`;this.$http.delete(e).then(l=>{l.data.success&&this.getProducts()}).catch(l=>{l.response.data.message&&this.$swal("錯誤","刪除產品失敗","error")})}},mounted(){this.getProducts()}},ft={class:"container"},gt={class:"text-end my-md-5 my-3 custom-btn-primary"},bt={class:"table table-striped productTable"},vt=t("thead",null,[t("tr",null,[t("th",{width:"10"}),t("th",{width:"10"}),t("th",null,"產品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",{width:"150"},"狀態"),t("th",{width:"100"},"編輯")])],-1),yt={class:"pt-3"},Ut={href:"#"},xt=["onClick"],Vt=t("td",null,null,-1),kt=["src"],At={key:0,class:"bg-success text-center activeRounded"},Tt=t("span",null,"啟用",-1),wt=[Tt],Mt={key:1,class:"bg-warning text-center activeRounded"},Ct=t("span",null,"未啟用",-1),$t=[Ct],Et=["onClick"];function Lt(i,e,l,n,o,a){const s=g("VueLoading"),m=g("Pagination"),P=g("ProductModal");return d(),r(v,null,[f(s,{active:o.isLoading},null,8,["active"]),t("div",ft,[t("div",gt,[t("button",{class:"btn btn-lg",onClick:e[0]||(e[0]=u=>a.openModal(!0))},"新增產品")]),t("table",bt,[vt,t("tbody",null,[(d(!0),r(v,null,V(o.products,u=>(d(),r("tr",{key:u.id},[t("td",yt,[t("a",Ut,[t("i",{class:"bi bi-x h3 text-danger",onClick:y(k=>a.delProduct(u),["prevent"])},null,8,xt)])]),Vt,t("td",null,[t("img",{class:"",width:"80",height:"50",src:u.imageUrl},null,8,kt),C(" "+b(u.title),1)]),t("td",null,b(u.origin_price),1),t("td",null,b(u.price),1),t("td",null,[u.is_enabled?(d(),r("div",At,wt)):(d(),r("div",Mt,$t))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-dark",onClick:y(k=>a.openModal(!1,u),["prevent"])}," 編輯 ",8,Et)])]))),128))])])]),f(m,{pages:o.pagination,onUpdatePage:a.getProducts},null,8,["pages","onUpdatePage"]),f(P,{ref:"modalComponent",product:o.tempProduct,onUpdateProduct:a.updateProduct},null,8,["product","onUpdateProduct"])],64)}const Bt=x(Pt,[["render",Lt]]);export{Bt as default};
