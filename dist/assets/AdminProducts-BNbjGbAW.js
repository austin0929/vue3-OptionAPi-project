import{P as w}from"./PaginationComponent-Idygglvc.js";import{m as M}from"./modalMixins-BlWN4yH2.js";import{_ as x,o as n,c as d,b as t,y as r,z as a,I as C,F as v,v as k,f as L,d as P,r as b,g as y,e as A,t as f}from"./index-z9VVAXen.js";import{i as U}from"./index-CwHr2tNN.js";import{V as T}from"./VueLoading-DTgNEhzE.js";const $={props:["product"],data(){return{modal:null,tempProduct:{}}},methods:{addProduct(){this.$emit("update-product",this.tempProduct)}},watch:{product(){this.tempProduct=this.product}},mixins:[M]},E={class:"modal fade",tabindex:"-1",ref:"myModal"},R={class:"modal-dialog modal-lg"},B={class:"modal-content"},I=t("div",{class:"modal-header bg-primary"},[t("h5",{class:"modal-title text-light"},"新增產品"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),N={class:"modal-body"},S={class:"row"},D={class:"col-8"},H={class:"row"},O={class:"col-4"},j=t("label",{for:"title",class:"form-label"},"產品名稱",-1),F={class:"col-4"},z=t("label",{for:"category",class:"form-label"},"分類",-1),q={class:"col-4"},G=t("label",{for:"unit",class:"form-label"},"單位",-1),J={class:"col-6"},K=t("label",{for:"origin_price",class:"form-label mt-3"},"原價",-1),Q={class:"col-6"},W=t("label",{for:"price",class:"form-label mt-3"},"特價",-1),X=t("label",{for:"description",class:"form-label mt-3"},"產品描述",-1),Y=t("label",{for:"content",class:"form-label mt-3"},"產品說明",-1),Z={class:"mt-2"},tt=t("label",{class:"form-check-label ms-1",for:"is_enabled"},"是否啟用",-1),et={class:"col-4"},ot=t("label",{for:"imgUrl",class:"form-label"},"輸入圖片網址",-1),st=["src"],lt={key:0,class:"mt-3"},it=["src"],nt=["onUpdate:modelValue"],dt={class:"modal-footer"},rt=t("button",{type:"button",class:"btn btn-dark","data-bs-dismiss":"modal"},"取消",-1);function ct(i,e,l,p,o,u){return n(),d("div",E,[t("div",R,[t("div",B,[I,t("div",N,[t("div",S,[t("div",D,[t("div",H,[t("div",O,[j,r(t("input",{type:"text",class:"form-control",placeholder:"請輸入產品名稱",id:"title","onUpdate:modelValue":e[0]||(e[0]=s=>o.tempProduct.title=s)},null,512),[[a,o.tempProduct.title]])]),t("div",F,[z,r(t("input",{type:"text",class:"form-control",id:"category",placeholder:"請輸入產品分類","onUpdate:modelValue":e[1]||(e[1]=s=>o.tempProduct.category=s)},null,512),[[a,o.tempProduct.category]])]),t("div",q,[G,r(t("input",{type:"text",class:"form-control",id:"unit",placeholder:"請輸入產品單位","onUpdate:modelValue":e[2]||(e[2]=s=>o.tempProduct.unit=s)},null,512),[[a,o.tempProduct.unit]])]),t("div",J,[K,r(t("input",{type:"text",class:"form-control",id:"origin_price",placeholder:"請輸入產品原價","onUpdate:modelValue":e[3]||(e[3]=s=>o.tempProduct.origin_price=s)},null,512),[[a,o.tempProduct.origin_price,void 0,{number:!0}]])]),t("div",Q,[W,r(t("input",{type:"text",class:"form-control",id:"price",placeholder:"請輸入產品價格","onUpdate:modelValue":e[4]||(e[4]=s=>o.tempProduct.price=s)},null,512),[[a,o.tempProduct.price,void 0,{number:!0}]])]),t("div",null,[X,r(t("textarea",{id:"description",type:"text",class:"form-control",placeholder:"請輸入產品描述","onUpdate:modelValue":e[5]||(e[5]=s=>o.tempProduct.description=s)},`\r
                  `,512),[[a,o.tempProduct.description]])]),t("div",null,[Y,r(t("textarea",{id:"content",type:"text",class:"form-control",placeholder:"請輸入產品說明","onUpdate:modelValue":e[6]||(e[6]=s=>o.tempProduct.content=s)},`\r
                  `,512),[[a,o.tempProduct.content]])]),t("div",Z,[r(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[7]||(e[7]=s=>o.tempProduct.is_enabled=s)},null,512),[[C,o.tempProduct.is_enabled]]),tt])])]),t("div",et,[t("div",null,[ot,r(t("input",{type:"text",class:"form-control mb-3",id:"imgUrl",placeholder:"請輸入圖片網址","onUpdate:modelValue":e[8]||(e[8]=s=>o.tempProduct.imageUrl=s)},null,512),[[a,o.tempProduct.imageUrl]]),t("img",{class:"img-fluid",src:o.tempProduct.imageUrl},null,8,st)]),Array.isArray(o.tempProduct.imagesUrl)?(n(),d("div",lt,[(n(!0),d(v,null,k(o.tempProduct.imagesUrl,(s,m)=>(n(),d("div",{key:s},[t("img",{src:s,alt:"product-modal-img",class:"img-fluid object-fit-cover w-100"},null,8,it),r(t("input",{type:"text","onUpdate:modelValue":g=>o.tempProduct.imagesUrl[m]=g,class:"form-control"},null,8,nt),[[a,o.tempProduct.imagesUrl[m]]])]))),128)),o.tempProduct.imagesUrl.length===0||o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length-1]?(n(),d("button",{key:0,class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[9]||(e[9]=s=>o.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(n(),d("button",{key:1,class:"btn btn-outline-danger btn-sm d-block w-100",onClick:e[10]||(e[10]=s=>o.tempProduct.imagesUrl.pop())}," 刪除圖片 "))])):L("",!0)])])]),t("div",dt,[rt,t("button",{type:"button",class:"btn btn-primary",onClick:e[11]||(e[11]=(...s)=>u.addProduct&&u.addProduct(...s))},"確認")])])])],512)}const at=x($,[["render",ct]]);var ut={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"david555",BASE_URL:"/vue3-OptionAPi-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_URL:_,VITE_APP_PATH:h}=ut,pt={components:{Pagination:w,ProductModal:at,VueLoading:T},data(){return{products:[],pagination:{},tempProduct:{},isNewProduct:!1,isLoading:!1}},methods:{getProducts(i=1){this.isLoading=!0;const e=`${_}/api/${h}/admin/products?page=${i}`;this.$http.get(e).then(l=>{l.data.success&&(this.products=l.data.products,this.pagination=l.data.pagination,setTimeout(()=>{this.isLoading=!1},800))}).catch(l=>{l.response.data.message&&this.$swal("錯誤","你所查看的API不存在","error")})},openModal(i,e){i?this.tempProduct={}:this.tempProduct={...e},this.isNewProduct=i,this.$refs.modalComponent.showModal()},updateProduct(i){this.tempProduct=i;let e=`${_}/api/${h}/admin/product`,l="post";this.isNewProduct||(e=`${_}/api/${h}/admin/product/${i.id}`,l="put"),this.$http[l](e,{data:this.tempProduct}).then(p=>{p.data.success&&(U("更新產品狀態",{theme:"auto",type:"success",autoClose:1e3,hideProgressBar:!0,dangerouslyHTMLString:!0}),this.$refs.modalComponent.hideModal(),this.getProducts())}).catch(p=>{p.response.data.message&&U("新增產品失敗",{theme:"auto",type:"error",autoClose:1e3,hideProgressBar:!0,dangerouslyHTMLString:!0})})},delProduct(i){const e=`${_}/api/${h}/admin/product/${i.id}`;this.$http.delete(e).then(l=>{l.data.success&&this.getProducts()}).catch(l=>{l.response.data.message&&this.$swal("錯誤","刪除產品失敗","error")})}},mounted(){this.getProducts()}},mt={class:"container"},_t={class:"text-end my-md-5 my-3 custom-btn-primary"},ht={class:"table table-striped productTable"},gt=t("thead",null,[t("tr",null,[t("th",{width:"10"}),t("th",{width:"10"}),t("th",null,"產品名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",{width:"150"},"狀態"),t("th",{width:"100"},"編輯")])],-1),Pt={class:"pt-3"},bt={href:"#"},ft=["onClick"],vt=t("td",null,null,-1),yt=["src"],Ut={key:0,class:"bg-success text-center activeRounded"},xt=t("span",null,"啟用",-1),kt=[xt],Vt={key:1,class:"bg-warning text-center activeRounded"},wt=t("span",null,"未啟用",-1),Mt=[wt],Ct=["onClick"];function Lt(i,e,l,p,o,u){const s=b("VueLoading"),m=b("Pagination"),g=b("ProductModal");return n(),d(v,null,[P(s,{active:o.isLoading},null,8,["active"]),t("div",mt,[t("div",_t,[t("button",{class:"btn btn-lg",onClick:e[0]||(e[0]=c=>u.openModal(!0))},"新增產品")]),t("table",ht,[gt,t("tbody",null,[(n(!0),d(v,null,k(o.products,c=>(n(),d("tr",{key:c.id},[t("td",Pt,[t("a",bt,[t("i",{class:"bi bi-x h3 text-danger",onClick:y(V=>u.delProduct(c),["prevent"])},null,8,ft)])]),vt,t("td",null,[t("img",{class:"",width:"80",height:"50",src:c.imageUrl},null,8,yt),A(" "+f(c.title),1)]),t("td",null,f(c.origin_price),1),t("td",null,f(c.price),1),t("td",null,[c.is_enabled?(n(),d("div",Ut,kt)):(n(),d("div",Vt,Mt))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-dark",onClick:y(V=>u.openModal(!1,c),["prevent"])}," 編輯 ",8,Ct)])]))),128))])])]),P(m,{pages:o.pagination,onUpdatePage:u.getProducts},null,8,["pages","onUpdatePage"]),P(g,{ref:"modalComponent",product:o.tempProduct,onUpdateProduct:u.updateProduct},null,8,["product","onUpdateProduct"])],64)}const Bt=x(pt,[["render",Lt]]);export{Bt as default};
