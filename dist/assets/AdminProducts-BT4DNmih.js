import { P as w } from './PaginationComponent-BHj4kVib.js'; import { m as M } from './modalMixins-gb6TmebJ.js'; import { _ as x, o as d, c as n, b as t, y as r, z as a, I as C, F as y, v as k, f as L, g, d as b, w as T, r as v, e as $, t as f } from './index-DrL7xUhK.js'; import { i as U } from './index-Bnm8mFos.js'; const A = { props: ['product'], data () { return { modal: null, tempProduct: {} } }, methods: { addProduct () { this.$emit('update-product', this.tempProduct) } }, watch: { product () { this.tempProduct = this.product } }, mixins: [M] }; const E = { class: 'modal fade', tabindex: '-1', ref: 'myModal' }; const R = { class: 'modal-dialog modal-lg' }; const B = { class: 'modal-content' }; const I = t('div', { class: 'modal-header bg-primary' }, [t('h5', { class: 'modal-title text-light' }, '新增產品'), t('button', { type: 'button', class: 'btn-close', 'data-bs-dismiss': 'modal', 'aria-label': 'Close' })], -1); const N = { class: 'modal-body' }; const S = { class: 'row' }; const D = { class: 'col-8' }; const H = { class: 'row' }; const q = { class: 'col-4' }; const j = t('label', { for: 'title', class: 'form-label' }, '產品名稱', -1); const F = { class: 'col-4' }; const O = t('label', { for: 'category', class: 'form-label' }, '分類', -1); const z = { class: 'col-4' }; const G = t('label', { for: 'unit', class: 'form-label' }, '單位', -1); const J = { class: 'col-6' }; const K = t('label', { for: 'origin_price', class: 'form-label mt-3' }, '原價', -1); const Q = { class: 'col-6' }; const W = t('label', { for: 'price', class: 'form-label mt-3' }, '特價', -1); const X = t('label', { for: 'description', class: 'form-label mt-3' }, '產品描述', -1); const Y = t('label', { for: 'content', class: 'form-label mt-3' }, '產品說明', -1); const Z = { class: 'mt-2' }; const tt = t('label', { class: 'form-check-label ms-1', for: 'is_enabled' }, '是否啟用', -1); const et = { class: 'col-4' }; const ot = t('label', { for: 'imgUrl', class: 'form-label' }, '輸入圖片網址', -1); const st = ['src']; const lt = { key: 0, class: 'mt-3' }; const it = ['src']; const dt = ['onUpdate:modelValue']; const nt = { class: 'modal-footer' }; const rt = t('button', { type: 'button', class: 'btn btn-dark', 'data-bs-dismiss': 'modal' }, '取消', -1); function ct (i, e, l, p, o, u) {
  return d(), n('div', E, [t('div', R, [t('div', B, [I, t('div', N, [t('div', S, [t('div', D, [t('div', H, [t('div', q, [j, r(t('input', { type: 'text', class: 'form-control', placeholder: '請輸入產品名稱', id: 'title', 'onUpdate:modelValue': e[0] || (e[0] = s => o.tempProduct.title = s) }, null, 512), [[a, o.tempProduct.title]])]), t('div', F, [O, r(t('input', { type: 'text', class: 'form-control', id: 'category', placeholder: '請輸入產品分類', 'onUpdate:modelValue': e[1] || (e[1] = s => o.tempProduct.category = s) }, null, 512), [[a, o.tempProduct.category]])]), t('div', z, [G, r(t('input', { type: 'text', class: 'form-control', id: 'unit', placeholder: '請輸入產品單位', 'onUpdate:modelValue': e[2] || (e[2] = s => o.tempProduct.unit = s) }, null, 512), [[a, o.tempProduct.unit]])]), t('div', J, [K, r(t('input', { type: 'text', class: 'form-control', id: 'origin_price', placeholder: '請輸入產品原價', 'onUpdate:modelValue': e[3] || (e[3] = s => o.tempProduct.origin_price = s) }, null, 512), [[a, o.tempProduct.origin_price, void 0, { number: !0 }]])]), t('div', Q, [W, r(t('input', { type: 'text', class: 'form-control', id: 'price', placeholder: '請輸入產品價格', 'onUpdate:modelValue': e[4] || (e[4] = s => o.tempProduct.price = s) }, null, 512), [[a, o.tempProduct.price, void 0, { number: !0 }]])]), t('div', null, [X, r(t('textarea', { id: 'description', type: 'text', class: 'form-control', placeholder: '請輸入產品描述', 'onUpdate:modelValue': e[5] || (e[5] = s => o.tempProduct.description = s) }, `\r
                  `, 512), [[a, o.tempProduct.description]])]), t('div', null, [Y, r(t('textarea', { id: 'content', type: 'text', class: 'form-control', placeholder: '請輸入產品說明', 'onUpdate:modelValue': e[6] || (e[6] = s => o.tempProduct.content = s) }, `\r
                  `, 512), [[a, o.tempProduct.content]])]), t('div', Z, [r(t('input', { id: 'is_enabled', class: 'form-check-input', type: 'checkbox', 'true-value': 1, 'false-value': 0, 'onUpdate:modelValue': e[7] || (e[7] = s => o.tempProduct.is_enabled = s) }, null, 512), [[C, o.tempProduct.is_enabled]]), tt])])]), t('div', et, [t('div', null, [ot, r(t('input', { type: 'text', class: 'form-control mb-3', id: 'imgUrl', placeholder: '請輸入圖片網址', 'onUpdate:modelValue': e[8] || (e[8] = s => o.tempProduct.imageUrl = s) }, null, 512), [[a, o.tempProduct.imageUrl]]), t('img', { class: 'img-fluid', src: o.tempProduct.imageUrl }, null, 8, st)]), Array.isArray(o.tempProduct.imagesUrl) ? (d(), n('div', lt, [(d(!0), n(y, null, k(o.tempProduct.imagesUrl, (s, m) => (d(), n('div', { key: s }, [t('img', { src: s, alt: 'product-modal-img', class: 'img-fluid object-fit-cover w-100' }, null, 8, it), r(t('input', { type: 'text', 'onUpdate:modelValue': P => o.tempProduct.imagesUrl[m] = P, class: 'form-control' }, null, 8, dt), [[a, o.tempProduct.imagesUrl[m]]])]))), 128)), o.tempProduct.imagesUrl.length === 0 || o.tempProduct.imagesUrl[o.tempProduct.imagesUrl.length - 1] ? (d(), n('button', { key: 0, class: 'btn btn-outline-primary btn-sm d-block w-100', onClick: e[9] || (e[9] = s => o.tempProduct.imagesUrl.push('')) }, ' 新增圖片 ')) : (d(), n('button', { key: 1, class: 'btn btn-outline-danger btn-sm d-block w-100', onClick: e[10] || (e[10] = s => o.tempProduct.imagesUrl.pop()) }, ' 刪除圖片 '))])) : L('', !0)])])]), t('div', nt, [rt, t('button', { type: 'button', class: 'btn btn-primary', onClick: e[11] || (e[11] = g((...s) => u.addProduct && u.addProduct(...s), ['prevent'])) }, '確認')])])])], 512)
} const at = x(A, [['render', ct]]); const ut = { VITE_APP_URL: 'https://vue3-course-api.hexschool.io/v2', VITE_APP_PATH: 'david555', BASE_URL: './', MODE: 'production', DEV: !1, PROD: !0, SSR: !1 }; const { VITE_APP_URL: _, VITE_APP_PATH: h } = ut; const pt = { components: { Pagination: w, ProductModal: at }, data () { return { products: [], pagination: {}, tempProduct: {}, isNewProduct: !1, isLoading: !1 } }, methods: { getProducts (i = 1) { this.isLoading = !0; const e = `${_}/api/${h}/admin/products?page=${i}`; this.$http.get(e).then(l => { l.data.success && (this.products = l.data.products, this.pagination = l.data.pagination, setTimeout(() => { this.isLoading = !1 }, 800)) }).catch(l => { l.response.data.message && this.$swal('錯誤', '你所查看的API不存在', 'error') }) }, openModal (i, e) { i ? this.tempProduct = {} : this.tempProduct = { ...e }, this.isNewProduct = i, this.$refs.modalComponent.showModal() }, updateProduct (i) { this.tempProduct = i; let e = `${_}/api/${h}/admin/product`; let l = 'post'; this.isNewProduct || (e = `${_}/api/${h}/admin/product/${i.id}`, l = 'put'), this.$http[l](e, { data: this.tempProduct }).then(p => { p.data.success && (U('更新產品狀態', { theme: 'auto', type: 'success', autoClose: 1e3, hideProgressBar: !0, dangerouslyHTMLString: !0 }), this.$refs.modalComponent.hideModal(), this.getProducts()) }).catch(p => { p.response.data.message && U('新增產品失敗', { theme: 'auto', type: 'error', autoClose: 1e3, hideProgressBar: !0, dangerouslyHTMLString: !0 }) }) }, delProduct (i) { const e = `${_}/api/${h}/admin/product/${i.id}`; this.$http.delete(e).then(l => { l.data.success && this.getProducts() }).catch(l => { l.response.data.message && this.$swal('錯誤', '刪除產品失敗', 'error') }) } }, mounted () { this.getProducts() } }; const mt = t('div', { class: 'loadingio-spinner-spin-nq4q5u6dq7r' }, [t('div', { class: 'ldio-x2uulkbinbj' }, [t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')]), t('div', null, [t('div')])])], -1); const _t = { class: 'container' }; const ht = { class: 'text-end my-4' }; const gt = { class: 'table table-striped productTable' }; const Pt = t('thead', null, [t('tr', null, [t('th', { width: '10' }), t('th', { width: '10' }), t('th', null, '產品名稱'), t('th', null, '原價'), t('th', null, '售價'), t('th', { width: '150' }, '狀態'), t('th', { width: '100' }, '編輯')])], -1); const bt = { class: 'pt-3' }; const vt = { href: '#' }; const ft = ['onClick']; const yt = t('td', null, null, -1); const Ut = ['src']; const xt = { key: 0, class: 'bg-success text-center activeRounded' }; const kt = t('span', null, '啟用', -1); const Vt = [kt]; const wt = { key: 1, class: 'bg-warning text-center activeRounded' }; const Mt = t('span', null, '未啟用', -1); const Ct = [Mt]; const Lt = ['onClick']; function Tt (i, e, l, p, o, u) { const s = v('VueLoading'); const m = v('Pagination'); const P = v('ProductModal'); return d(), n(y, null, [b(s, { active: o.isLoading }, { default: T(() => [mt]), _: 1 }, 8, ['active']), t('div', _t, [t('div', ht, [t('button', { class: 'btn btn-lg btn-primary', onClick: e[0] || (e[0] = g(c => u.openModal(!0), ['prevent'])) }, '新增產品')]), t('table', gt, [Pt, t('tbody', null, [(d(!0), n(y, null, k(o.products, c => (d(), n('tr', { key: c.id }, [t('td', bt, [t('a', vt, [t('i', { class: 'bi bi-x h3 text-danger', onClick: g(V => u.delProduct(c), ['prevent']) }, null, 8, ft)])]), yt, t('td', null, [t('img', { class: '', width: '80', height: '50', src: c.imageUrl }, null, 8, Ut), $(' ' + f(c.title), 1)]), t('td', null, f(c.origin_price), 1), t('td', null, f(c.price), 1), t('td', null, [c.is_enabled ? (d(), n('div', xt, Vt)) : (d(), n('div', wt, Ct))]), t('td', null, [t('button', { type: 'button', class: 'btn btn-outline-dark', onClick: g(V => u.openModal(!1, c), ['prevent']) }, ' 編輯 ', 8, Lt)])]))), 128))])])]), b(m, { pages: o.pagination, onUpdatePage: u.getProducts }, null, 8, ['pages', 'onUpdatePage']), b(P, { ref: 'modalComponent', product: o.tempProduct, onUpdateProduct: u.updateProduct }, null, 8, ['product', 'onUpdateProduct'])], 64) } const Bt = x(pt, [['render', Tt]]); export { Bt as default }
